<!DOCTYPE html>
<html lang="ru" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VAB BOOST | Админ-панель</title>
    
    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    
    <!-- CSS -->
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/admin.css">
    <link rel="stylesheet" href="css/responsive.css">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- Preloader -->
    <div class="preloader" id="preloader">
        <div class="preloader-inner">
            <div class="preloader-logo">
                <div class="valorant-icon">
                    <div class="v-shape"></div>
                    <div class="v-shape v-shape-2"></div>
                </div>
                <span class="logo-text">VAB BOOST</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill"></div>
            </div>
        </div>
    </div>

    <!-- Login Section (Initially Visible) -->
    <section class="login-section" id="loginSection">
        <div class="container">
            <div class="login-container">
                <div class="login-header">
                    <h2><span class="gradient-text">АДМИН-ПАНЕЛЬ</span></h2>
                    <p>Введите данные для входа</p>
                </div>
                
                <form id="loginForm" class="login-form">
                    <div class="form-group">
                        <label for="username">Имя пользователя</label>
                        <input type="text" id="username" name="username" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="password">Пароль</label>
                        <input type="password" id="password" name="password" required>
                    </div>
                    
                    <div class="form-group">
                        <button type="submit" class="btn btn-primary btn-block">
                            <i class="fas fa-sign-in-alt"></i> Войти
                        </button>
                    </div>
                </form>
                
                <div id="loginError" class="error-message hidden"></div>
            </div>
        </div>
    </section>

    <!-- Admin Dashboard (Initially Hidden) -->
    <div class="admin-dashboard hidden" id="adminDashboard">
        <!-- Admin Header -->
        <header class="admin-header">
            <div class="container">
                <div class="admin-header-content">
                    <div class="admin-logo">
                        <a href="/" class="logo">
                            <div class="logo-icon">
                                <i class="fas fa-fire"></i>
                            </div>
                            <span class="logo-text">VAB<span class="logo-accent">BOOST</span> ADMIN</span>
                        </a>
                    </div>
                    
                    <div class="admin-controls">
                        <div class="admin-user">
                            <i class="fas fa-user-circle"></i>
                            <span id="adminUsername">Администратор</span>
                        </div>
                        <button class="btn btn-outline btn-sm" id="logoutBtn">
                            <i class="fas fa-sign-out-alt"></i> Выйти
                        </button>
                        <div class="theme-toggle" id="adminThemeToggle">
                            <i class="fas fa-moon"></i>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Admin Sidebar -->
        <nav class="admin-sidebar" id="adminSidebar">
            <ul class="sidebar-menu">
                <li>
                    <a href="#dashboard" class="sidebar-link active" data-section="dashboard">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Дашборд</span>
                    </a>
                </li>
                <li>
                    <a href="#orders" class="sidebar-link" data-section="orders">
                        <i class="fas fa-shopping-cart"></i>
                        <span>Заказы</span>
                        <span class="badge" id="pendingOrdersCount">0</span>
                    </a>
                </li>
                <li>
                    <a href="#payments" class="sidebar-link" data-section="payments">
                        <i class="fas fa-credit-card"></i>
                        <span>Платежи</span>
                    </a>
                </li>
                <li>
                    <a href="#stats" class="sidebar-link" data-section="stats">
                        <i class="fas fa-chart-bar"></i>
                        <span>Статистика</span>
                    </a>
                </li>
                <li>
                    <a href="#reviews" class="sidebar-link" data-section="reviews">
                        <i class="fas fa-star"></i>
                        <span>Отзывы</span>
                    </a>
                </li>
                <li>
                    <a href="#settings" class="sidebar-link" data-section="settings">
                        <i class="fas fa-cog"></i>
                        <span>Настройки</span>
                    </a>
                </li>
            </ul>
            
            <div class="sidebar-footer">
                <div class="server-status">
                    <div class="status-indicator active"></div>
                    <span>Сервер активен</span>
                </div>
                <div class="current-time" id="currentTime">--:--:--</div>
            </div>
        </nav>

        <!-- Admin Main Content -->
        <main class="admin-content" id="adminContent">
            <!-- Dashboard Section -->
            <section class="admin-section active" id="dashboardSection">
                <div class="container">
                    <div class="section-header">
                        <h2>Дашборд</h2>
                        <p>Обзор активности и ключевые показатели</p>
                    </div>
                    
                    <!-- Stats Grid -->
                    <div class="stats-grid" id="statsGrid">
                        <!-- Stats will be loaded here -->
                    </div>
                    
                    <!-- Charts -->
                    <div class="charts-grid">
                        <div class="chart-card">
                            <h3>Доходы по дням</h3>
                            <div class="chart-container">
                                <canvas id="revenueChart"></canvas>
                            </div>
                        </div>
                        
                        <div class="chart-card">
                            <h3>Распределение услуг</h3>
                            <div class="chart-container">
                                <canvas id="servicesChart"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Recent Activity -->
                    <div class="activity-card">
                        <h3>Последняя активность</h3>
                        <div class="activity-list" id="activityList">
                            <!-- Activity will be loaded here -->
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Orders Section -->
            <section class="admin-section" id="ordersSection">
                <div class="container">
                    <div class="section-header">
                        <h2>Управление заказами</h2>
                        <p>Просмотр и управление всеми заказами</p>
                    </div>
                    
                    <!-- Filters -->
                    <div class="filters-card">
                        <div class="filter-row">
                            <div class="filter-group">
                                <label for="orderStatusFilter">Статус:</label>
                                <select id="orderStatusFilter">
                                    <option value="">Все статусы</option>
                                    <option value="pending">Ожидание</option>
                                    <option value="paid">Оплачен</option>
                                    <option value="processing">В работе</option>
                                    <option value="completed">Завершен</option>
                                    <option value="cancelled">Отменен</option>
                                </select>
                            </div>
                            
                            <div class="filter-group">
                                <label for="orderServiceFilter">Услуга:</label>
                                <select id="orderServiceFilter">
                                    <option value="">Все услуги</option>
                                    <option value="rank_boost">Повышение ранга</option>
                                    <option value="wins_boost">Буст побед</option>
                                    <option value="placement">Калибровка</option>
                                    <option value="coaching">Коучинг</option>
                                </select>
                            </div>
                            
                            <div class="filter-group">
                                <label for="orderDateFilter">Дата:</label>
                                <input type="date" id="orderDateFilter">
                            </div>
                            
                            <div class="filter-group">
                                <label for="orderSearch">Поиск:</label>
                                <input type="text" id="orderSearch" placeholder="Номер, контакт...">
                            </div>
                        </div>
                        
                        <div class="filter-actions">
                            <button class="btn btn-outline" id="resetFilters">
                                <i class="fas fa-redo"></i> Сбросить
                            </button>
                            <button class="btn btn-primary" id="applyFilters">
                                <i class="fas fa-filter"></i> Применить
                            </button>
                        </div>
                    </div>
                    
                    <!-- Orders Table -->
                    <div class="table-card">
                        <div class="table-header">
                            <h3>Заказы</h3>
                            <div class="table-actions">
                                <button class="btn btn-outline btn-sm" id="refreshOrders">
                                    <i class="fas fa-sync"></i> Обновить
                                </button>
                                <button class="btn btn-primary btn-sm" id="exportOrders">
                                    <i class="fas fa-download"></i> Экспорт
                                </button>
                            </div>
                        </div>
                        
                        <div class="table-responsive">
                            <table class="data-table" id="ordersTable">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Номер</th>
                                        <th>Услуга</th>
                                        <th>Сумма</th>
                                        <th>Статус</th>
                                        <th>Дата</th>
                                        <th>Действия</th>
                                    </tr>
                                </thead>
                                <tbody id="ordersTableBody">
                                    <!-- Orders will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- Pagination -->
                        <div class="pagination" id="ordersPagination">
                            <!-- Pagination will be loaded here -->
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Payments Section -->
            <section class="admin-section" id="paymentsSection">
                <div class="container">
                    <div class="section-header">
                        <h2>Платежи</h2>
                        <p>Управление платежами и возвратами</p>
                    </div>
                    
                    <!-- Payments Table -->
                    <div class="table-card">
                        <div class="table-header">
                            <h3>История платежей</h3>
                            <div class="table-actions">
                                <button class="btn btn-outline btn-sm" id="refreshPayments">
                                    <i class="fas fa-sync"></i> Обновить
                                </button>
                            </div>
                        </div>
                        
                        <div class="table-responsive">
                            <table class="data-table" id="paymentsTable">
                                <thead>
                                    <tr>
                                        <th>ID платежа</th>
                                        <th>Заказ</th>
                                        <th>Сумма</th>
                                        <th>Статус</th>
                                        <th>Дата</th>
                                        <th>Действия</th>
                                    </tr>
                                </thead>
                                <tbody id="paymentsTableBody">
                                    <!-- Payments will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Statistics Section -->
            <section class="admin-section" id="statsSection">
                <div class="container">
                    <div class="section-header">
                        <h2>Статистика</h2>
                        <p>Детальная аналитика и отчеты</p>
                    </div>
                    
                    <!-- Stats Filters -->
                    <div class="filters-card">
                        <div class="filter-row">
                            <div class="filter-group">
                                <label for="statsPeriod">Период:</label>
                                <select id="statsPeriod">
                                    <option value="day">Сегодня</option>
                                    <option value="week">Неделя</option>
                                    <option value="month" selected>Месяц</option>
                                    <option value="year">Год</option>
                                    <option value="custom">Выбрать даты</option>
                                </select>
                            </div>
                            
                            <div class="filter-group custom-date hidden">
                                <label for="startDate">С:</label>
                                <input type="date" id="startDate">
                            </div>
                            
                            <div class="filter-group custom-date hidden">
                                <label for="endDate">По:</label>
                                <input type="date" id="endDate">
                            </div>
                            
                            <div class="filter-group">
                                <button class="btn btn-primary" id="generateReport">
                                    <i class="fas fa-chart-line"></i> Сгенерировать отчет
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Detailed Stats -->
                    <div class="stats-detailed">
                        <div class="stat-card big">
                            <h3>Общая статистика</h3>
                            <div class="stat-details" id="overallStats">
                                <!-- Overall stats will be loaded here -->
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <h3>Топ услуги</h3>
                            <div class="stat-details" id="topServices">
                                <!-- Top services will be loaded here -->
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <h3>Топ регионы</h3>
                            <div class="stat-details" id="topRegions">
                                <!-- Top regions will be loaded here -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- Charts -->
                    <div class="charts-grid">
                        <div class="chart-card full-width">
                            <h3>Динамика заказов</h3>
                            <div class="chart-container">
                                <canvas id="ordersChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Reviews Section -->
            <section class="admin-section" id="reviewsSection">
                <div class="container">
                    <div class="section-header">
                        <h2>Управление отзывами</h2>
                        <p>Просмотр и модерация отзывов клиентов</p>
                    </div>
                    
                    <!-- Reviews List -->
                    <div class="reviews-admin">
                        <div class="reviews-list" id="reviewsList">
                            <!-- Reviews will be loaded here -->
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Settings Section -->
            <section class="admin-section" id="settingsSection">
                <div class="container">
                    <div class="section-header">
                        <h2>Настройки системы</h2>
                        <p>Конфигурация параметров сайта</p>
                    </div>
                    
                    <!-- Settings Tabs -->
                    <div class="settings-tabs">
                        <div class="tab-buttons">
                            <button class="tab-btn active" data-tab="general">Основные</button>
                            <button class="tab-btn" data-tab="payment">Оплата</button>
                            <button class="tab-btn" data-tab="notifications">Уведомления</button>
                            <button class="tab-btn" data-tab="security">Безопасность</button>
                        </div>
                        
                        <!-- General Settings -->
                        <div class="tab-content active" id="generalTab">
                            <form id="generalSettingsForm" class="settings-form">
                                <div class="form-group">
                                    <label for="siteName">Название сайта</label>
                                    <input type="text" id="siteName" name="site_name" value="VAB BOOST">
                                </div>
                                
                                <div class="form-group">
                                    <label for="siteUrl">URL сайта</label>
                                    <input type="url" id="siteUrl" name="site_url" value="https://vab-boost.ru">
                                </div>
                                
                                <div class="form-group">
                                    <label for="supportEmail">Email поддержки</label>
                                    <input type="email" id="supportEmail" name="support_email" value="support@vab-boost.ru">
                                </div>
                                
                                <div class="form-group">
                                    <label for="telegramLink">Telegram для связи</label>
                                    <input type="text" id="telegramLink" name="telegram_link" value="@vabboost_support">
                                </div>
                                
                                <div class="form-group">
                                    <label for="maintenanceMode">Режим обслуживания</label>
                                    <select id="maintenanceMode" name="maintenance_mode">
                                        <option value="0">Выключен</option>
                                        <option value="1">Включен</option>
                                    </select>
                                </div>
                                
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-save"></i> Сохранить изменения
                                </button>
                            </form>
                        </div>
                        
                        <!-- Payment Settings -->
                        <div class="tab-content" id="paymentTab">
                            <form id="paymentSettingsForm" class="settings-form">
                                <div class="form-group">
                                    <label for="yookassaShopId">Shop ID ЮKassa</label>
                                    <input type="text" id="yookassaShopId" name="yookassa_shop_id" value="1226686">
                                </div>
                                
                                <div class="form-group">
                                    <label for="yookassaSecretKey">Секретный ключ ЮKassa</label>
                                    <input type="password" id="yookassaSecretKey" name="yookassa_secret_key">
                                </div>
                                
                                <div class="form-group">
                                    <label for="yookassaWebhook">Webhook URL</label>
                                    <input type="url" id="yookassaWebhook" name="yookassa_webhook" value="https://vab-boost.ru/api/payments.php?action=webhook" readonly>
                                    <small>Скопируйте этот URL в настройках ЮKassa</small>
                                </div>
                                
                                <div class="form-group">
                                    <label for="currency">Валюта</label>
                                    <select id="currency" name="currency">
                                        <option value="RUB" selected>Рубли (RUB)</option>
                                        <option value="USD">Доллары (USD)</option>
                                        <option value="EUR">Евро (EUR)</option>
                                    </select>
                                </div>
                                
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-save"></i> Сохранить настройки оплаты
                                </button>
                            </form>
                        </div>
                        
                        <!-- Notification Settings -->
                        <div class="tab-content" id="notificationsTab">
                            <form id="notificationSettingsForm" class="settings-form">
                                <div class="form-group checkbox-group">
                                    <input type="checkbox" id="emailNotifications" name="email_notifications" checked>
                                    <label for="emailNotifications">Email уведомления</label>
                                </div>
                                
                                <div class="form-group">
                                    <label for="adminEmail">Email администратора</label>
                                    <input type="email" id="adminEmail" name="admin_email" value="admin@vab-boost.ru">
                                </div>
                                
                                <div class="form-group checkbox-group">
                                    <input type="checkbox" id="telegramNotifications" name="telegram_notifications">
                                    <label for="telegramNotifications">Telegram уведомления</label>
                                </div>
                                
                                <div class="form-group">
                                    <label for="telegramBotToken">Токен Telegram бота</label>
                                    <input type="text" id="telegramBotToken" name="telegram_bot_token">
                                </div>
                                
                                <div class="form-group">
                                    <label for="telegramChatId">ID чата Telegram</label>
                                    <input type="text" id="telegramChatId" name="telegram_chat_id">
                                </div>
                                
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-save"></i> Сохранить настройки уведомлений
                                </button>
                            </form>
                        </div>
                        
                        <!-- Security Settings -->
                        <div class="tab-content" id="securityTab">
                            <form id="securitySettingsForm" class="settings-form">
                                <div class="form-group">
                                    <label for="currentPassword">Текущий пароль</label>
                                    <input type="password" id="currentPassword" name="current_password">
                                </div>
                                
                                <div class="form-group">
                                    <label for="newPassword">Новый пароль</label>
                                    <input type="password" id="newPassword" name="new_password">
                                    <small>Минимум 8 символов, включая заглавные буквы и цифры</small>
                                </div>
                                
                                <div class="form-group">
                                    <label for="confirmPassword">Подтвердите пароль</label>
                                    <input type="password" id="confirmPassword" name="confirm_password">
                                </div>
                                
                                <div class="form-group">
                                    <label for="sessionTimeout">Таймаут сессии (минуты)</label>
                                    <input type="number" id="sessionTimeout" name="session_timeout" value="60" min="5" max="1440">
                                </div>
                                
                                <div class="form-group checkbox-group">
                                    <input type="checkbox" id="twoFactorAuth" name="two_factor_auth">
                                    <label for="twoFactorAuth">Двухфакторная аутентификация</label>
                                </div>
                                
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-save"></i> Сохранить настройки безопасности
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Modals -->
        
        <!-- Order Details Modal -->
        <div class="modal" id="orderDetailsModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Детали заказа <span id="modalOrderNumber"></span></h3>
                    <button class="modal-close">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="order-details-grid" id="orderDetailsContent">
                        <!-- Order details will be loaded here -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-outline" id="editOrderBtn">Редактировать</button>
                    <button class="btn btn-primary" id="saveOrderBtn" style="display: none;">Сохранить</button>
                    <button class="btn btn-danger" id="cancelOrderBtn">Отменить заказ</button>
                </div>
            </div>
        </div>
        
        <!-- Payment Details Modal -->
        <div class="modal" id="paymentDetailsModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Детали платежа</h3>
                    <button class="modal-close">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="payment-details" id="paymentDetailsContent">
                        <!-- Payment details will be loaded here -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-danger" id="refundPaymentBtn">Вернуть платеж</button>
                </div>
            </div>
        </div>
        
        <!-- Confirmation Modal -->
        <div class="modal" id="confirmationModal">
            <div class="modal-content small">
                <div class="modal-header">
                    <h3>Подтверждение</h3>
                    <button class="modal-close">&times;</button>
                </div>
                <div class="modal-body">
                    <p id="confirmationMessage">Вы уверены?</p>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-outline" id="cancelConfirmBtn">Отмена</button>
                    <button class="btn btn-danger" id="confirmActionBtn">Подтвердить</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/script.js"></script>
    <script src="js/admin.js"></script>
</body>
</html>